
<!--TODO: change delete to disable...-->
<!-- Button trigger modal -->
<!--  <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal">-->
<!--    Delete Account?-->
<!--  </button>-->

<!--  &lt;!&ndash; Modal &ndash;&gt;-->
<!--  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">-->
<!--    <div class="modal-dialog modal-dialog-centered">-->
<!--      <div class="modal-content">-->
<!--        <div class="modal-header">-->
<!--          <h5 class="modal-title" id="exampleModalLabel" th:text="${user.username}">Modal Title</h5>-->
<!--          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>-->
<!--        </div>-->
<!--        <div class="modal-body">-->
<!--          ARE YOU SURE YOU WANT TO DELETE YOUR ACCOUNT?-->
<!--        </div>-->
<!--        <div class="modal-footer">-->
<!--          <form th:method="post" th:action="@{|/profile/${user.getId()}/delete|}">-->
<!--            <label for="passwordDelete">Enter your password to confirm deletion: </label>-->
<!--            <br>-->
<!--            <input type="password" name="passwordDelete" placeholder="Password" id="passwordDelete"/>-->
<!--            <br>-->
<!--            <input hidden name="id" th:value="${user.id}">-->
<!--            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>-->
<!--            <button type="submit" class="btn btn-danger">Delete Account</button>-->
<!--          </form>-->
<!--        </div>-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Edit profile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We"
          crossorigin="anonymous">
    <!--    font awesome kit-->
    <script src="https://kit.fontawesome.com/d0d640b552.js" crossorigin="anonymous"></script>
    <th:block th:replace="partials/style.html :: style"></th:block>
    <link rel="stylesheet" href="../static/css/main.css">
    <!--    CSS for fix some visual problems-->
    <style>
        body {
            margin-top: 20px;
            background: #f8f8f8
        }

        a {
            text-decoration: none;
        }
    </style>
</head>
<body>
<nav th:replace="partials/navbar.html :: navbar"></nav>
<br>
<div class="container">
    <br>
    <form class="row flex-lg-nowrap" id="pick-form"
         th:action="@{|/profile/${user.getId()}/edit|}" th:method="post"
         th:object="${user}">
        <!--    left box with links-->
<!--        <div class="col-12 col-lg-auto mb-3" style="width: 200px;">-->
<!--            <div class="card p-3">-->
<!--                <div class="e-navlist e-navlist&#45;&#45;active-bg">-->
<!--                    <ul class="nav">-->
<!--                        <li class="nav-item"><a class="nav-link px-2 active" href="/event">-->
<!--                            <i class="fas fa-calendar-week"></i> <span>Events</span></a></li>-->
<!--                        <li class="nav-item"><a class="nav-link px-2" href="/profile"-->
<!--                        ><i class="fas fa-users"></i> <span>Profile</span></a></li>-->
<!--                        <li class="nav-item"><a class="nav-link px-2" href="/"-->
<!--                        ><i class="fas fa-home"></i> <span>Home</span></a></li>-->
<!--                    </ul>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
        <!--main content with forms-->
        <div class="col">
            <div class="row">
                <div class="col mb-3">
                    <div class="card">
                        <div class="card-body">
                            <div class="e-profile">
                                <div class="row">
                                    <!--Here go the avatar img-->
                                    <div class="col-12 col-sm-auto mb-3">
                                        <div class="mx-auto" style="width: 140px;">
                                          <div class="pic">
                                            <img id="changeImage" th:src="${user.imageUrl}" alt="No Profile Picture">
                                          </div>
                                            <div class="control" id="nameBox"></div>
                                            <div class="control" id="urlBox"></div>
                                        </div>
                                    </div>
                                    <div class="col d-flex flex-column flex-sm-row justify-content-between mb-3">
                                        <div class="text-center text-sm-left mb-2 mb-sm-0">
                                            <h4 class="text-center text-sm-left mb-2 mb-sm-0"
                                                th:text="${user.displayName}"></h4>
                                            <br>
                                            <div class="desc" th:if="${user.getPromoter()}">
                                                <p class="mb-0">Promoter</p>
                                            </div>
                                            <div class="desc" th:if="!${user.getPromoter()}">
                                                <p class="mb-0">Musician/Band</p>
                                            </div>
                                            <!--change avatar pic-->
                                            <div class="control mt-2">
                                                <button class="btn btn-primary" type="button" id="picker">
                                                    <input type="hidden" th:value="${user.imageUrl}" id="fileupload" name="fileupload">
                                                    <i class="fa fa-fw fa-camera"></i>
                                                    <span>Change Photo</span>
                                                    <!--<div class="control" id="nameBox"></div>-->
                                                    <!--<div class="control" id="urlBox"></div>-->
                                                </button>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <ul class="nav nav-tabs">
                                    <li class="nav-item"><a href="" class="active nav-link">Settings</a></li>
                                </ul>
                                <!--start form here-->
                                <div class="tab-content pt-3">
                                    <div class="tab-pane active">
                                            <div class="row">
                                                <div class="col">
                                                    <div class="row">
                                                        <!--Display name-->
                                                        <div class="col">
                                                            <div class="form-group">
                                                                <label for="displayName">Display Name</label>
                                                                <input class="form-control" type="text"
                                                                       placeholder="Stone Cold"
                                                                       th:field="*{displayName}"
                                                                       id="displayName">
                                                            </div>
                                                        </div>
                                                        <!--Email address -->
                                                        <div class="col">
                                                            <div class="form-group">
                                                                <label for="email">Email Address</label>
                                                                <input class="form-control" type="text"
                                                                       placeholder="user@example.com"
                                                                       th:field="*{email}" id="email">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!--Bio text-->
                                                    <div class="row">
                                                        <div class="col mb-3">
                                                            <div class="form-group">
                                                                <label for="bio">Bio</label>
                                                                <textarea class="form-control" rows="5"
                                                                          placeholder="My Bio" th:field="*{bio}"
                                                                          id="bio"></textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!--change password form-->
<!--                                      TODO: Put this in a separate modal, or change controller to check values and work accordingly. -->
<!--                                      -->
<!--                                            <div class="row">-->
<!--                                                <div class="col-12 col-sm-6 mb-3">-->
<!--                                                    <div class="mb-2"><b>Change Password</b></div>-->
<!--                                                    <div class="row">-->
<!--                                                        <div class="col">-->
<!--                                                            <div class="form-group">-->
<!--                                                                <label>Current Password</label>-->
<!--                                                                <input class="form-control" type="password"-->
<!--                                                                       placeholder="••••••">-->
<!--                                                            </div>-->
<!--                                                        </div>-->
<!--                                                    </div>-->
<!--                                                    <div class="row">-->
<!--                                                        <div class="col">-->
<!--                                                            <div class="form-group">-->
<!--                                                                <label>New Password</label>-->
<!--                                                                <input class="form-control" type="password"-->
<!--                                                                       placeholder="••••••">-->
<!--                                                            </div>-->
<!--                                                        </div>-->
<!--                                                    </div>-->
                                                    <!--confirm password-->
                                                    <div class="row">
                                                        <div class="col">
                                                            <div class="form-group">
                                                                <label for="password">Confirm <span
                                                                        class="d-none d-xl-inline">Password</span></label>
                                                                <input class="form-control" type="password"
                                                                       name="password" id="password"
                                                                       required></div>
                                                            <input hidden th:field="*{id}" th:value="${user.id}">
                                                            <input hidden th:field="*{username}"
                                                                   th:value="${user.username}">
                                                            <input hidden name="isPromoter"
                                                                   th:value="${user.getPromoter()}">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!--checkbox menu-->
                                                <div class="col-12 col-sm-5 offset-sm-1 mb-3">
                                                    <div class="mb-2"><b>Please Confirm your Password before sending changes!</b></div>
                                                    <!--Genres Id-->
                                                    <div class="row">
                                                        <div class="col">
                                                            <!--    Stuff below for genreIds-->
                                                            <input hidden type="checkbox" th:id="ignore"
                                                                   name="genreIds"
                                                                   value="ignore" checked>
                                                            <div th:if="!${user.getPromoter()}">
                                                                <div>Genres for the Band:</div>
                                                                <br>
                                                                <div th:each="genre: ${genres}">
                                                                    <label th:for="${genre.genreName}">
                                                                        <input type="checkbox"
                                                                               th:id="${genre.genreName}"
                                                                               name="genreIds"
                                                                               th:value="${genre.genreName}"
                                                                               th:text="${genre.genreName}"></label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col d-flex justify-content-end">
                                                    <button class="btn btn-primary" type="submit" value="Submit">
                                                        Save
                                                        Changes
                                                    </button>
                                                </div>
                                            </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--logout-->
<!--              <div class="col-12 col-md-3 mb-3">-->
<!--                <div class="card mb-3">-->
<!--                  <div class="card-body">-->
<!--                    &lt;!&ndash;logout button access&ndash;&gt;-->
<!--                    <div class="px-xl-3">-->
<!--                      <button class="btn btn-block btn-secondary" sec:authorize="isAuthenticated()">-->
<!--                        <form id="logoutButton" th:action="@{/logout}" th:method="post"-->
<!--                              style="cursor: pointer">-->
<!--                          <a style="color: #fff" class="nav-link" onclick="this.parentNode.submit();"><i-->
<!--                            class="fa fa-sign-out"></i>Logout</a>-->
<!--                        </form>-->
<!--                      </button>-->
<!--                    </div>-->
<!--                  </div>-->
<!--                </div>-->
<!--                    &lt;!&ndash;contact us&ndash;&gt;-->
<!--                    <div class="card">-->
<!--                        <div class="card-body">-->
<!--                            <h6 class="card-title font-weight-bold">Support</h6>-->
<!--                            <p class="card-text">Get fast, free help from our friendly assistants.</p>-->
<!--                            <button type="button" class="btn btn-block btn-primary">-->
<!--                                <span><a style="color: #fff" href="/contact">Contact Us</a></span>-->
<!--                            </button>-->

<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->

    </form>
</div>
<th:block th:replace="partials/scripts.html :: scripts"></th:block>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="../../static/js/keys.js"></script>
<script src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>


<script>
    // Set up the picker
    const client = filestack.init('Ay308pTSYSUWR4gzj51Q8z');
    const options = {
        onUploadDone: updateForm,
        maxSize: 10 * 1024 * 1024,
        accept: 'image/*',
        uploadInBackground: false,
    };
    const picker = client.picker(options);

    // Get references to the DOM elements

    const form = document.getElementById('pick-form');
    const fileInput = document.getElementById('fileupload');
    const btn = document.getElementById('picker');
    const nameBox = document.getElementById('nameBox');
    const urlBox = document.getElementById('urlBox');

    // Add our event listeners

    btn.addEventListener('click', function (e) {
        e.preventDefault();
        picker.open();
    });

    form.addEventListener('submit', function (e) {
        // e.preventDefault();
        alert('Submitting: ' + fileInput.value);
    });

    // Helper to overwrite the field input value

    function updateForm(result) {
        const fileData = result.filesUploaded[0];
        fileInput.value = fileData.url;

        // Some ugly DOM code to show some data.
        const name = document.createTextNode('Selected: ' + fileData.filename);
        const url = document.createElement('a');
        url.href = fileData.url;
        url.appendChild(document.createTextNode(fileData.url));
        nameBox.appendChild(name);
        urlBox.appendChild(document.createTextNode('Uploaded to: '));
        urlBox.appendChild(url);
        $('#changeImage').attr('src',url);

    };
</script>
</body>
</html>
